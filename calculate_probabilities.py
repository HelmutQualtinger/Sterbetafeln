import re
import os

def calculate_decade_probabilities(csv_content):
    lines = csv_content.strip().split('\n')

    # Skip header lines (assuming 10 header lines based on previous analysis)
    data_lines = lines[10:]

    combined_px_data = {}
    for line in data_lines:
        parts = line.split(';')
        if not parts:
            continue
        
        age_str = parts[0].strip()
        age_match = re.match(r'(\d+)', age_str)
        if not age_match:
            continue
        age = int(age_match.group(1))

        male_qx_str = parts[1].replace('e', '').replace(',', '.').strip()
        male_qx = float(male_qx_str) if male_qx_str else 0.0

        female_qx_str = parts[15].replace('e', '').replace(',', '.').strip()
        female_qx = float(female_qx_str) if female_qx_str else 0.0

        combined_qx = (male_qx + female_qx) / 2
        combined_px = 1 - combined_qx
        
        combined_px_data[age] = combined_px

    decade_probabilities = {}
    for decade_start in range(0, 100, 10):
        decade_end = decade_start + 9
        decade_label = f'{decade_start}-{decade_end}'
        
        product_of_px = 1.0
        
        for age in range(decade_start, decade_start + 10):
            if age in combined_px_data:
                product_of_px *= combined_px_data[age]
            else:
                product_of_px = 0.0 # If any p(x) is missing, assume 0 for product
                break
                
        probability_of_death_in_decade = 1 - product_of_px
        decade_probabilities[decade_label] = probability_of_death_in_decade

    if 100 in combined_px_data:
        decade_probabilities['100+'] = 1 - combined_px_data[100]

    return decade_probabilities

csv_content_2018 = """Tabelle: 12621-0001
Sterbetafel (Periodensterbetafel): Deutschland, Jahre,;;;;;;;;;;;;;;
Geschlecht, Vollendetes Alter;;;;;;;;;;;;;;
Sterbetafeln;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Deutschland;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;Geschlecht;;;;;;;;;;;;;;;;;;;;;;;;;;;
;männlich;;;;;;;;;;;;;;weiblich;;;;;;;;;;;;;
;Sterbewahrscheinlichkeit [q(x)];;Überlebenswahrscheinlichkeit [p(x)];;Überlebende [l(x)];;Gestorbene [d(x)];;Bis zum Alter x+1 durchlebte Jahre [L(x)];;Insgesamt noch zu durchlebende Jahre [T(x)];;Durchschnittliche Lebenserwartung [e(x)];;Sterbewahrscheinlichkeit [q(x)];;Überlebenswahrscheinlichkeit [p(x)];;Überlebende [l(x)];;Gestorbene [d(x)];;Bis zum Alter x+1 durchlebte Jahre [L(x)];;Insgesamt noch zu durchlebende Jahre [T(x)];;Durchschnittliche Lebenserwartung [e(x)];
;Ziffer;Ziffer;Ziffer;Ziffer;Anzahl;Anzahl;Anzahl;Anzahl;Jahre;Jahre;Jahre;Jahre;Jahre;Jahre;Ziffer;Ziffer;Ziffer;Ziffer;Anzahl;Anzahl;Anzahl;Anzahl;Jahre;Jahre;Jahre;Jahre;Jahre;Jahre
2016/18;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0 Jahre;0,00356226;e;0,99643774;e;100000;e;356;e;99692;e;7847962;e;78,48;e;0,00300534;e;0,99699466;e;100000;e;301;e;99741;e;8326646;e;83,27;e
1 Jahr;0,00027641;e;0,99972359;e;99644;e;28;e;99630;e;7748270;e;77,76;e;0,00024794;e;0,99975206;e;99699;e;25;e;99687;e;8226904;e;82,52;e
2 Jahre;0,00015611;e;0,99984389;e;99616;e;16;e;99608;e;7648640;e;76,78;e;0,00012423;e;0,99987577;e;99675;e;12;e;99669;e;8127217;e;81,54;e
3 Jahre;0,00010894;e;0,99989106;e;99601;e;11;e;99595;e;7549031;e;75,79;e;0,00010313;e;0,99989687;e;99662;e;10;e;99657;e;8027549;e;80,55;e
4 Jahre;0,00010653;e;0,99989347;e;99590;e;11;e;99585;e;7449436;e;74,80;e;0,00009569;e;0,99990431;e;99652;e;10;e;99647;e;7927891;e;79,56;e
5 Jahre;0,00010046;e;0,99989954;e;99579;e;10;e;99574;e;7349852;e;73,81;e;0,00008908;e;0,99991092;e;99643;e;9;e;99638;e;7828244;e;78,56;e
6 Jahre;0,00009091;e;0,99990909;e;99569;e;9;e;99565;e;7250277;e;72,82;e;0,00008846;e;0,99991154;e;99634;e;9;e;99629;e;7728606;e;77,57;e
7 Jahre;0,00008614;e;0,99991386;e;99560;e;9;e;99556;e;7150713;e;71,82;e;0,00004646;e;0,99995354;e;99625;e;5;e;99623;e;7628977;e;76,58;e
8 Jahre;0,00008552;e;0,99991448;e;99552;e;9;e;99547;e;7051157;e;70,83;e;0,00006968;e;0,99993032;e;99620;e;7;e;99617;e;7529354;e;75,58;e
9 Jahre;0,00008001;e;0,99991999;e;99543;e;8;e;99539;e;6951610;e;69,84;e;0,00006117;e;0,99993883;e;99613;e;6;e;99610;e;7429737;e;74,59;e
10 Jahre;0,00007924;e;0,99992076;e;99535;e;8;e;99531;e;6852070;e;68,84;e;0,00005849;e;0,99994151;e;99607;e;6;e;99604;e;7330127;e;73,59;e
11 Jahre;0,00007740;e;0,99992260;e;99527;e;8;e;99523;e;6752539;e;67,85;e;0,00007733;e;0,99992267;e;99601;e;8;e;99598;e;7230523;e;72,59;e
12 Jahre;0,00006884;e;0,99993116;e;99520;e;7;e;99516;e;6653016;e;66,85;e;0,00007852;e;0,99992148;e;99594;e;8;e;99590;e;7130925;e;71,60;e
13 Jahre;0,00009588;e;0,99990412;e;99513;e;10;e;99508;e;6553500;e;65,86;e;0,00009421;e;0,99990579;e;99586;e;9;e;99581;e;7031336;e;70,61;e
14 Jahre;0,00013566;e;0,99986434;e;99503;e;13;e;99496;e;6453992;e;64,86;e;0,00009221;e;0,99990779;e;99576;e;9;e;99572;e;6931754;e;69,61;e
15 Jahre;0,00015987;e;0,99984013;e;99490;e;16;e;99482;e;6354496;e;63,87;e;0,00012167;e;0,99987833;e;99567;e;12;e;99561;e;6832183;e;68,62;e
16 Jahre;0,00024747;e;0,99975253;e;99474;e;25;e;99461;e;6255014;e;62,88;e;0,00014725;e;0,99985275;e;99555;e;15;e;99548;e;6732621;e;67,63;e
17 Jahre;0,00027475;e;0,99972525;e;99449;e;27;e;99435;e;6155552;e;61,90;e;0,00013616;e;0,99986384;e;99541;e;14;e;99534;e;6633074;e;66,64;e
18 Jahre;0,00038318;e;0,99961682;e;99422;e;38;e;99403;e;6056117;e;60,91;e;0,00019702;e;0,99980298;e;99527;e;20;e;99517;e;6533540;e;65,65;e
19 Jahre;0,00039767;e;0,99960233;e;99384;e;40;e;99364;e;5956714;e;59,94;e;0,00017479;e;0,99982521;e;99507;e;17;e;99499;e;6434023;e;64,66;e
20 Jahre;0,00043184;e;0,99956816;e;99344;e;43;e;99323;e;5857350;e;58,96;e;0,00018488;e;0,99981512;e;99490;e;18;e;99481;e;6334524;e;63,67;e
21 Jahre;0,00040526;e;0,99959474;e;99301;e;40;e;99281;e;5758028;e;57,99;e;0,00016490;e;0,99983510;e;99472;e;16;e;99463;e;6235043;e;62,68;e
22 Jahre;0,00045366;e;0,99954634;e;99261;e;45;e;99239;e;5658746;e;57,01;e;0,00016281;e;0,99983719;e;99455;e;16;e;99447;e;6135580;e;61,69;e
23 Jahre;0,00040954;e;0,99959046;e;99216;e;41;e;99196;e;5559508;e;56,03;e;0,00017996;e;0,99982004;e;99439;e;18;e;99430;e;6036133;e;60,70;e
24 Jahre;0,00047486;e;0,99952514;e;99175;e;47;e;99152;e;5460312;e;55,06;e;0,00017994;e;0,99982006;e;99421;e;18;e;99412;e;5936703;e;59,71;e
25 Jahre;0,00043792;e;0,99956208;e;99128;e;43;e;99107;e;5361160;e;54,08;e;0,00019022;e;0,99980978;e;99403;e;19;e;99394;e;5837291;e;58,72;e
26 Jahre;0,00045886;e;0,99954114;e;99085;e;45;e;99062;e;5262054;e;53,11;e;0,00018820;e;0,99981180;e;99384;e;19;e;99375;e;5737897;e;57,73;e
27 Jahre;0,00046183;e;0,99953817;e;99039;e;46;e;99017;e;5162992;e;52,13;e;0,00021518;e;0,99978482;e;99366;e;21;e;99355;e;5638522;e;56,75;e
28 Jahre;0,00048486;e;0,99951514;e;98994;e;48;e;98970;e;5063975;e;51,15;e;0,00023564;e;0,99976436;e;99344;e;23;e;99332;e;5539167;e;55,76;e
29 Jahre;0,00052165;e;0,99947835;e;98946;e;52;e;98920;e;4965006;e;50,18;e;0,00025877;e;0,99974123;e;99321;e;26;e;99308;e;5439835;e;54,77;e
30 Jahre;0,00056139;e;0,99943861;e;98894;e;56;e;98866;e;4866086;e;49,21;e;0,00031713;e;0,99968287;e;99295;e;31;e;99279;e;5340527;e;53,78;e
31 Jahre;0,00061587;e;0,99938413;e;98839;e;61;e;98808;e;4767220;e;48,23;e;0,00031400;e;0,99968600;e;99264;e;31;e;99248;e;5241247;e;52,80;e
32 Jahre;0,00063400;e;0,99936600;e;98778;e;63;e;98746;e;4668411;e;47,26;e;0,00034263;e;0,99965737;e;99232;e;34;e;99215;e;5141999;e;51,82;e
33 Jahre;0,00073168;e;0,99926832;e;98715;e;72;e;98679;e;4569665;e;46,29;e;0,00036033;e;0,99963967;e;99198;e;36;e;99181;e;5042784;e;50,84;e
34 Jahre;0,00076954;e;0,99923046;e;98643;e;76;e;98605;e;4470986;e;45,33;e;0,00040600;e;0,99959400;e;99163;e;40;e;99143;e;4943603;e;49,85;e
35 Jahre;0,00080225;e;0,99919775;e;98567;e;79;e;98527;e;4372381;e;44,36;e;0,00041213;e;0,99958787;e;99122;e;41;e;99102;e;4844461;e;48,87;e
36 Jahre;0,00085947;e;0,99914053;e;98488;e;85;e;98445;e;4273854;e;43,39;e;0,00045850;e;0,99954150;e;99082;e;45;e;99059;e;4745359;e;47,89;e
37 Jahre;0,00097983;e;0,99902017;e;98403;e;96;e;98355;e;4175409;e;42,43;e;0,00047466;e;0,99952534;e;99036;e;47;e;99013;e;4646300;e;46,92;e
38 Jahre;0,00106768;e;0,99893232;e;98307;e;105;e;98254;e;4077054;e;41,47;e;0,00060325;e;0,99939675;e;98989;e;60;e;98959;e;4547287;e;45,94;e
39 Jahre;0,00111397;e;0,99888603;e;98202;e;109;e;98147;e;3978799;e;40,52;e;0,00060115;e;0,99939885;e;98929;e;59;e;98900;e;4448328;e;44,96;e
40 Jahre;0,00123774;e;0,99876226;e;98092;e;121;e;98032;e;3880652;e;39,37;e;0,00068570;e;0,99931430;e;98870;e;68;e;98836;e;4349428;e;43,99;e
41 Jahre;0,00133379;e;0,99866621;e;97971;e;131;e;97906;e;3782621;e;38,61;e;0,00074026;e;0,99925974;e;98802;e;73;e;98766;e;4250592;e;43,02;e
42 Jahre;0,00144076;e;0,99855924;e;97840;e;141;e;97770;e;3684715;e;37,66;e;0,00079376;e;0,99920624;e;98729;e;78;e;98690;e;4151827;e;42,05;e
43 Jahre;0,00153974;e;0,99846026;e;97699;e;150;e;97624;e;3586945;e;36,71;e;0,00090807;e;0,99909193;e;98651;e;90;e;98606;e;4053137;e;41,09;e
44 Jahre;0,00179800;e;0,99820200;e;97549;e;175;e;97461;e;3489321;e;35,77;e;0,00097058;e;0,99902942;e;98561;e;96;e;98513;e;3954531;e;40,12;e
45 Jahre;0,00195870;e;0,99804130;e;97374;e;191;e;97278;e;3391860;e;34,83;e;0,00115224;e;0,99884776;e;98465;e;113;e;98409;e;3856018;e;39,16;e
46 Jahre;0,00217916;e;0,99782084;e;97183;e;212;e;97077;e;3294582;e;33,90;e;0,00121751;e;0,99878249;e;98352;e;120;e;98292;e;3757609;e;38,21;e
47 Jahre;0,00236791;e;0,99763209;e;96971;e;230;e;96856;e;3197505;e;32,97;e;0,00137030;e;0,99862970;e;98232;e;135;e;98165;e;3659317;e;37,25;e
48 Jahre;0,00265551;e;0,99734449;e;96741;e;257;e;96613;e;3100649;e;32,05;e;0,00159405;e;0,99840595;e;98098;e;156;e;98019;e;3553629;e;36,30;e
49 Jahre;0,00297126;e;0,99702874;e;96484;e;287;e;96341;e;3004036;e;31,13;e;0,00174807;e;0,99825193;e;97941;e;171;e;97856;e;3455621;e;35,36;e
50 Jahre;0,00332421;e;0,99667579;e;96198;e;320;e;96038;e;2907694;e;30,23;e;0,00185320;e;0,99814680;e;97770;e;181;e;97679;e;3357765;e;34,42;e
51 Jahre;0,00370198;e;0,99629802;e;95878;e;355;e;95701;e;2811656;e;29,33;e;0,00214270;e;0,99785730;e;97589;e;209;e;97484;e;3267598;e;33,48;e
52 Jahre;0,00414072;e;0,99585928;e;95523;e;396;e;95325;e;2715956;e;28,43;e;0,00233297;e;0,99766703;e;97380;e;227;e;97266;e;3162582;e;32,55;e
53 Jahre;0,00469739;e;0,99530261;e;95128;e;447;e;94904;e;2620631;e;27,55;e;0,00256767;e;0,99743233;e;97153;e;249;e;97028;e;3065287;e;31,54;e
54 Jahre;0,00531626;e;0,99468374;e;94681;e;503;e;94429;e;2525726;e;26,68;e;0,00288870;e;0,99711130;e;96903;e;280;e;96763;e;2968216;e;30,61;e
55 Jahre;0,00591257;e;0,99408743;e;94177;e;557;e;93899;e;2431297;e;25,82;e;0,00324545;e;0,99675455;e;96623;e;314;e;96466;e;2871391;e;29,70;e
56 Jahre;0,00658737;e;0,99341263;e;93621;e;617;e;93312;e;2337399;e;24,97;e;0,00357696;e;0,99642304;e;96310;e;344;e;96137;e;2774840;e;28,78;e
57 Jahre;0,00733233;e;0,99266767;e;93004;e;682;e;92663;e;2244086;e;24,13;e;0,00392413;e;0,99607587;e;95965;e;377;e;95777;e;2686453;e;27,99;e
58 Jahre;0,00815644;e;0,99184356;e;92322;e;753;e;91945;e;2151423;e;23,30;e;0,00434941;e;0,99565059;e;95588;e;416;e;95381;e;2582670;e;27,10;e
59 Jahre;0,00893714;e;0,99106286;e;91569;e;818;e;91160;e;2059478;e;22,49;e;0,00470636;e;0,99529364;e;95173;e;448;e;94949;e;2495295;e;26,22;e
60 Jahre;0,00983124;e;0,99016876;e;90750;e;892;e;90304;e;1968318;e;21,69;e;0,00527596;e;0,99472404;e;94725;e;500;e;94475;e;2391964;e;25,34;e
61 Jahre;0,01082143;e;0,98917857;e;89858;e;972;e;89372;e;1878014;e;20,90;e;0,00568588;e;0,99431412;e;94225;e;536;e;93957;e;2203058;e;24,47;e
62 Jahre;0,01194124;e;0,98805876;e;88886;e;1061;e;88355;e;1788642;e;20,12;e;0,00613444;e;0,99386556;e;93689;e;575;e;93402;e;2211915;e;23,61;e
63 Jahre;0,01297814;e;0,98702186;e;87825;e;1140;e;87255;e;1700287;e;19,36;e;0,00674890;e;0,99325110;e;93115;e;628;e;92800;e;2118513;e;22,59;e
64 Jahre;0,01425244;e;0,98574756;e;86685;e;1235;e;86067;e;1613032;e;18,61;e;0,00747267;e;0,99252733;e;92486;e;691;e;92141;e;2025712;e;21,90;e
65 Jahre;0,01542111;e;0,98457889;e;85449;e;1318;e;84790;e;1526965;e;17,87;e;0,00797044;e;0,99202956;e;91795;e;732;e;91429;e;1923972;e;21,06;e
66 Jahre;0,01660601;e;0,98339399;e;84132;e;1397;e;83433;e;1442175;e;17,14;e;0,00876211;e;0,99123789;e;91063;e;798;e;90664;e;1832327;e;20,08;e
67 Jahre;0,01895626;e;0,98104374;e;82711;e;1568;e;81927;e;1340206;e;16,20;e;0,00975485;e;0,99024515;e;90352;e;881;e;89911;e;1741488;e;19,26;e
68 Jahre;0,02063084;e;0,97936916;e;81143;e;1674;e;80306;e;1258279;e;15,51;e;0,01081606;e;0,98918394;e;89471;e;968;e;88987;e;1651525;e;18,45;e
69 Jahre;0,02231726;e;0,97768274;e;79469;e;1774;e;78582;e;1177973;e;14,82;e;0,01193152;e;0,98806848;e;88503;e;1056;e;88001;e;1562504;e;17,65;e
70 Jahre;0,02385767;e;0,97614233;e;77695;e;1854;e;76769;e;1099391;e;14,15;e;0,01298143;e;0,98694500;e;87447;e;1142;e;86897;e;1474503;e;16,86;e
71 Jahre;0,02601351;e;0,97398649;e;75842;e;1973;e;74855;e;1022623;e;13,48;e;0,01426390;e;0,98562893;e;86312;e;1231;e;85696;e;1385464;e;16,05;e
72 Jahre;0,02774052;e;0,97225948;e;73869;e;2049;e;72844;e;947767;e;12,83;e;0,01566548;e;0,98433452;e;85081;e;1333;e;84414;e;1301900;e;15,30;e
73 Jahre;0,03062776;e;0,96937224;e;71820;e;2200;e;70720;e;874923;e;12,18;e;0,01736568;e;0,98263432;e;83748;e;1454;e;83021;e;1215354;e;14,54;e
74 Jahre;0,03263171;e;0,96736829;e;69620;e;2272;e;68484;e;804203;e;11,55;e;0,01881626;e;0,98118374;e;82293;e;1566;e;81519;e;1134486;e;13,79;e
75 Jahre;0,03621112;e;0,96378888;e;67348;e;2439;e;66129;e;735719;e;10,92;e;0,02117195;e;0,97882805;e;80745;e;1746;e;79836;e;1052993;e;13,05;e
76 Jahre;0,03854289;e;0,96145711;e;64909;e;2502;e;63658;e;669591;e;10,32;e;0,02312367;e;0,97687633;e;79035;e;1875;e;78122;e;973157;e;12,32;e
77 Jahre;0,04272360;e;0,95727640;e;62408;e;2666;e;61074;e;605932;e;9,71;e;0,02603233;e;0,97396767;e;77208;e;2010;e;76203;e;895132;e;11,56;e
78 Jahre;0,04671341;e;0,95328659;e;59741;e;2791;e;58346;e;544858;e;9,12;e;0,02894780;e;0,97105220;e;75016;e;2225;e;73904;e;819080;e;10,92;e
79 Jahre;0,05058769;e;0,94941231;e;56951;e;2881;e;55510;e;486512;e;8,54;e;0,03202169;e;0,96797831;e;72791;e;2437;e;71573;e;745176;e;10,24;e
80 Jahre;0,05742838;e;0,94257162;e;54070;e;3105;e;52517;e;431002;e;7,97;e;0,03671192;e;0,96328808;e;70354;e;2655;e;69026;e;673603;e;9,57;e
81 Jahre;0,06364272;e;0,93635728;e;50964;e;3244;e;49343;e;378485;e;7,43;e;0,04139273;e;0,95860727;e;67699;e;2818;e;66282;e;604577;e;8,93;e
82 Jahre;0,07117296;e;0,92882704;e;47721;e;3396;e;46023;e;329142;e;6,90;e;0,04769522;e;0,95230478;e;64866;e;3111;e;63311;e;538295;e;8,30;e
83 Jahre;0,07988296;e;0,92011704;e;44325;e;3541;e;42554;e;283119;e;6,39;e;0,05346615;e;0,94653385;e;61756;e;3302;e;60105;e;474984;e;7,69;e
84 Jahre;0,09006952;e;0,90993048;e;40784;e;3673;e;38947;e;244387;e;5,90;e;0,06201409;e;0,93654469;e;58742;e;3728;e;56641;e;414879;e;7,10;e
85 Jahre;0,10299344;e;0,89700656;e;37110;e;3822;e;35199;e;205084;e;5,43;e;0,07155933;e;0,92844067;e;54829;e;3924;e;52867;e;358237;e;6,53;e
86 Jahre;0,11663819;e;0,88336181;e;33288;e;3883;e;31347;e;166419;e;5,00;e;0,08316910;e;0,91683090;e;50905;e;4234;e;48789;e;305370;e;6,00;e
87 Jahre;0,13348160;e;0,86651840;e;29406;e;3925;e;27443;e;135072;e;4,59;e;0,10097498;e;0,89902502;e;46672;e;4550;e;44397;e;256582;e;5,50;e
88 Jahre;0,14798808;e;0,85201192;e;25480;e;3771;e;23595;e;107629;e;4,22;e;0,11204515;e;0,88795485;e;42122;e;4720;e;39762;e;207709;e;4,97;e
89 Jahre;0,16885600;e;0,83114400;e;21710;e;3666;e;19877;e;84034;e;3,87;e;0,13149788;e;0,86850212;e;37035;e;4870;e;34600;e;168288;e;4,54;e
90 Jahre;0,18891546;e;0,81108454;e;18044;e;3409;e;16339;e;64157;e;3,56;e;0,14687996;e;0,85312004;e;32610;e;4790;e;30215;e;137417;e;4,21;e
91 Jahre;0,20911492;e;0,79088508;e;14635;e;3060;e;13105;e;47818;e;3,27;e;0,16817467;e;0,83182533;e;27820;e;4679;e;25481;e;107202;e;3,85;e
92 Jahre;0,23679869;e;0,76320131;e;11575;e;2741;e;10204;e;35299;e;3,00;e;0,19055034;e;0,80944966;e;23142;e;4410;e;20937;e;81721;e;3,53;e
93 Jahre;0,25746006;e;0,74253994;e;8834;e;2274;e;7697;e;24508;e;2,77;e;0,21259961;e;0,78740039;e;18732;e;3982;e;16741;e;60784;e;3,24;e
94 Jahre;0,28397340;e;0,71602660;e;6559;e;1863;e;5628;e;16812;e;2,56;e;0,23609014;e;0,76390986;e;14750;e;3482;e;13008;e;44043;e;2,99;e
95 Jahre;0,30858525;e;0,69141475;e;4697;e;1449;e;3972;e;11184;e;2,38;e;0,26132342;e;0,73867658;e;11267;e;2944;e;9795;e;31035;e;2,75;e
96 Jahre;0,34011514;e;0,65988486;e;3247;e;1104;e;2695;e;7275;e;2,22;e;0,28571950;e;0,71428050;e;8323;e;2378;e;7134;e;21239;e;2,55;e
97 Jahre;0,35548447;e;0,64451553;e;2143;e;762;e;1762;e;4520;e;2,11;e;0,31110631;e;0,68889369;e;5945;e;1850;e;5020;e;14105;e;2,37;e
98 Jahre;0,36901386;e;0,63098614;e;1381;e;510;e;1126;e;2754;e;1,99;e;0,33983410;e;0,66016590;e;4095;e;1392;e;3400;e;9085;e;2,22;e
99 Jahre;0,39304405;e;0,60695595;e;871;e;343;e;700;e;1628;e;1,87;e;0,35873355;e;0,64137239;e;2704;e;970;e;2219;e;5686;e;2,10;e
100 Jahre;0,41781413;e;0,58218587;e;529;e;221;e;418;e;928;e;1,75;e;0,37225504;e;0,62774496;e;1734;e;645;e;1411;e;3467;e;2,00;e
"""

if __name__ == "__main__":
    results_2018 = calculate_decade_probabilities(csv_content_2018)
    results_2022 = calculate_decade_probabilities(csv_content_2022)
    results_2024 = calculate_decade_probabilities(csv_content_2024)

    all_decade_labels = sorted(list(set(results_2018.keys()) | set(results_2022.keys()) | set(results_2024.keys())),
                               key=lambda item: int(item.split('-')[0]) if '-' in item else int(item.replace('+', '')) if item.endswith('+') else 999)

    print(f"{ 'Dekade':<15} | {'2016-2018':<15} | {'2020-2022':<15} | {'2022-2024':<15}")
    print(f"{'-'*15} | {'-'*15} | {'-'*15} | {'-'*15}")

    for label in all_decade_labels:
        prob_2018 = results_2018.get(label)
        prob_2022 = results_2022.get(label)
        prob_2024 = results_2024.get(label)

        prob_2018_str = f"{prob_2018:.6f}" if isinstance(prob_2018, float) else "N/A"
        prob_2022_str = f"{prob_2022:.6f}" if isinstance(prob_2022, float) else "N/A"
        prob_2024_str = f"{prob_2024:.6f}" if isinstance(prob_2024, float) else "N/A"

        print(f"{label:<15} | {prob_2018_str:<15} | {prob_2022_str:<15} | {prob_2024_str:<15}")